<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Partial Fractions and Bézout's Lemma</title>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      extensions: ["tex2jax.js"],
      jax: ["input/TeX", "output/HTML-CSS"],
      tex2jax: {
        inlineMath: [ ['$latex','$'] ], //Use the delimiters used by the latex plugin on mathemafrica
        processEscapes: true
      },
      TeX: {
        extensions: ["AMSmath.js", "AMSsymbols.js"]
      },
      "HTML-CSS": { fonts: ["TeX"] }
    });
  </script>
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js">
  </script>
  <link rel="stylesheet" href="./posts.css" />
</head>
<body>

<header>
<h1>Partial Fractions and Bézout's Lemma</h1>
<!-- <p>This post can be read on <a href="http://www.mathemafrica.org/?p=...">mathemafrica.org</a></p> -->
</header>

<article>
<!-- Delete up to here when copying to mathemafrica -->

<h3>Bézout's Lemma</h3>
<p>Bézout's Lemma is a result in elementary number theory that is often used as a key ingredient in the proof of the Fundamental Theorem of Arithmetic. You may be surprised to learn that you learned a version of this result in first year calculus, though it was almost certainly not called Bézout's Lemma in the course.</p>
<blockquote>
  <h4>Bezout's Lemma</h4>
  <p>If $latex m$ and $latex n$ are any integers, then there are integers $latex s$ and $latex t$ such that</p>
  <p style="text-align: center;">$latex \displaystyle ms + nt = \gcd(m, n)$,</p>
  <p>where $latex \gcd(m, n)$ is the greatest common divisor of $latex m$ and $latex n$.</p>
</blockquote>

<p>In particular, we then know that if $latex m$ and $latex n$ are <em>relatively prime</em> (which is to say that they have no factors in common other than $latex \pm 1$), then there are integers $latex s$ and $latex t$ such that</p>
<p style="text-align: center;">$latex \displaystyle ms + nt = 1.$</p>
<p>The value in knowing this is that it allows us to prove <em>Euclid's Lemma</em>.</p>

<h3>Euclid's Lemma</h3>
<blockquote>
  <h4>Euclid's Lemma</h4>
  <p>Suppose that $latex a$, $latex b$, and $latex c$ are integers such that $latex a \mid bc$. If $latex \gcd(a, b) = 1$, then $latex a \mid c$.</p>
</blockquote>
<p>Indeed, if $latex \gcd(a, b) = 1$, then Bézout's Lemma tells us that there are integers $latex s$ and $latex t$ such that</p>
<p style="text-align: center;">$latex \displaystyle sa + tb = 1$.</p>
<p>Multiplying by $latex c$ gives us that</p>
<p style="text-align: center;">$latex \displaystyle sac + tbc = c$.</p>
<p>We know that $latex a \mid sac$, and by assumption we have that $latex a \mid tbc$ since $latex a \mid bc$. It follows that $latex a$ also divides the sum of these two numbers; in other words we have that $latex a \mid c$.</p>

<h3>The Fundamental Theorem of Arithmetic</h3>

<p>Euclid's Lemma provides a means to prove the uniqueness of the prime factorisation of a number. Consider a prime $latex p$, and suppose that $latex p \mid ab$ for some integers $latex a$ and $latex b$. Then either $latex p$ divides $latex a$, or $latex p$ and $latex a$ have no factors in common at all! (Other than $latex \pm 1$.) This is because the only factors that they could possibly have <em>in common</em> are the factors of $latex p$, which&mdash;since $latex p$ is a prime&mdash;are $latex 1$ and $latex p$. There are thus two possibilities: either $latex p \mid a$, or $latex \gcd(p, a) = 1$, in which case Euclid's Lemma tells us that $latex p \mid b$. A proof using the principle of mathematical induction allows us to extend this to the following result:</p>
<blockquote>
  <p>Suppose that $latex p$ is a prime, and</p>
  <p style="text-align: center;">$latex \displaystyle p \mid a_1 a_2 a_3 \cdots a_k$</p>
  <p>for some integers $latex a_1, a_2, \dots, a_n$. Then $latex p \mid a_i$ for some $latex i \in \{1, 2, \dots, k\}$.</p>
</blockquote>
<p>To see how this applies to the Fundamental Theorem of Arithmetic, suppose that</p>
<p style="text-align: center;">$latex \displaystyle n = p_1^{a_1} p_2^{a_2} \cdots p_k^{a_k}$</p>
<p>and</p>
<p style="text-align: center;">$latex \displaystyle n = q_1^{b_1} q_2^{b_2} \cdots q_m^{b_m}$</p>
<p>are two <em>different</em> prime factorisations of the number $latex n$. Since</p>
<p style="text-align: center;">$latex \displaystyle p_1 \mid q_1^{b_1} q_2^{b_2} \cdots q_m^{b_m}$,</p>
<p>we know that $latex p_1 \mid q_i$ for some $latex i$, and since $latex q_i$ is prime and $latex p_1 \neq 1$, this implies that $latex p_1 = q_i$. This then implies that the number</p>
<p style="text-align: center;">$latex \displaystyle \frac{n}{p_1} = \frac{n}{q_i} = p_1^{a_1 - 1} p_2^{a_2} \cdots p_k^{a_k} = q_1^{b_1} \cdots q_{i - 1}^{b_{i - 1}} q_i^{b_i - 1} q_{i + 1}^{b_{i + 1}} \cdots q_m^{b_m}$</p>
<p>also has two different prime factorisations. We can imagine applying this procedure to all of the primes $latex p_i$ and eventually we would come to the conclusion that the number $latex 1$ has two different prime factorisations, which is absurd. Alternatively, the proof could be presented as a proof using the (strong) principle of mathematical induction: since $latex \frac{n}{p_1} &lt; n$, we can apply the inductive hypothesis to conclude that $latex \frac{n}{p_1}$ in fact has a unique prime factorisation, which then implies that the two factorisations of $latex n$ aren't distinct after all.</p>

<h3>The Proof of Bézout's Lemma</h3>

<p>A standard proof of Bézout's Lemma considers the set of all positive integers of the form $latex ms + nt$ for some integers $latex s$ and $latex t$. One can show that the smallest element of this set divides both $latex m$ and $latex n$. I prefer to think of Bézout's Lemma as a consequence of Euclid's Algorithm.</p>
<p>Euclid's Algorithm is a method to calculate the greatest common divisor of two numbers $latex m$ and $latex n$. On each step of the algorithm, we consider two numbers $latex a_k$ and $latex b_k$. Initially these two numbers are $latex m$ and $latex n$ themselves. We then replace the larger of the two numbers with the difference of the two numbers. In other words, if $latex a_k > b_k$, then we set $latex a_{k + 1} = a_k - b_k$, and $latex b_{k + 1} = b_k$. We do a similar substitution if $latex b_k > a_k$.</p>
<p>We claim that on each step of the algorith, the greatest common divisor of the two numbers being considered doesn't change. In other words, $latex \gcd(a_{k + 1}, b_{k + 1}) = \gcd(a_k, b_k)$. In fact the set of all common divisors of the two numbers being considered doesn't change, and so of course the largest element of this set also does not change.</p>
<p>To see this, suppose that $latex d \mid a_k$ and $latex d \mid b_k$. Then we also have that $latex d \mid a_k - b_k$ and $latex d \mid b_k$. Thus if $latex a_k > b_k$, it follows that $latex d \mid a_{k + 1} = a_k - b_k$ and $latex d \mid b_{k + 1} = b_k$. A similar proof applies in the case where $latex b_k > a_k$. Thus the set of common divisors of $latex a_k$ and $latex b_k$ is a <em>subset</em> of the set of common divisors of $latex a_{k + 1}$ and $latex b_{k + 1}$. Conversely, suppose that $latex d \mid a_{k + 1}$ and $latex d \mid b_{k + 1}$. Then we also have that $latex d \mid a_{k + 1} + b_{k + 1}$, which is equal to either $latex a_k$ or $latex b_k$, depending on which is larger. Since either $latex a_{k + 1} = a_k$ or $latex b_{k + 1} = b_k$, depending on which is larger, we see that $latex d$ is also a common divisor of $latex a_k$ and $latex b_k$, whence the two sets of common divisors are in fact equal.</p>
<p>The final thing to note about Euclid's Algorithm is that eventually the two numbers being considered stops changing; the algorithm stops after a finite number of steps. The reason for this is that the larger of the two numbers numbers being considered never increases. Since any decreasing sequence of positive integers is eventually constant, we know that the larger of the two numbers eventually stops changing. Thinking about how we replace the two numbers under consideration shows that at this point the smaller number must be equal to $latex 0$. Since $latex \gcd(a, 0) = a$ for all $latex a$, the larger number is then the greatest common divisor of $latex m$ and $latex n$ which we sought.</p>
<p>What does this have to do with Bézout's Lemma? The thing to notice is that if at any step of the algorithm, the two numbers being considered are both a linear combination of $latex m$ and $latex n$, then this is also true on the next step of the algorithm.</p>
<p>In other words, we initially have that there are integers $latex s_0, t_0, u_0$, and $latex v_0$ such that $latex a_0 = s_0 m + t_0 n$, and $latex b_0 = u_0 m + v_0 n$. In fact, we can take $latex s_0 = v_0 = 1$ and $latex t_0 = u_0 = 0$. Now suppose that we know that $latex a_k = s_k m + t_k n$ and $latex b_k = u_k m + v_k n$. Then if $latex a_k > b_k$, we have that $latex a_{k + 1} = s_{k + 1} m + t_{k + 1} n$ and $latex b_{k + 1} = u_{k + 1} m + v_{k + 1} n$ where $latex s_{k + 1} = s_k - u_k$, $latex t_{k + 1} = t_k - v_k$, $latex u_{k + 1} = u_k$ and $latex v_{k + 1} = v_k$. A similar proof works when $latex b_k > a_k$.</p>
<p>But we also know that on some step of the algorithm, the larger of the two numbers is $latex \gcd(m, n)$!</p>

<h3>And now for something completely different</h3>

When learning to integrate rational functions, students are introduced to the method of <em>partial fractions</em>. This method guarantees us that if $latex A(x)$ and $latex B(x)$ are polynomials, and $latex B(x)$ cam be factorised as
<p style="text-align: center;">$latex \displaystyle B(x) = B_1(x)^{a_1} B_2(x)^{a_2} \cdots B_k(x)^{a_k}$,</p>
<p>where each of the factors $latex B_1, B_2, \dots B_k$ are irreducible (although we actually only need the $latex B_i$ to be pairwise relatively prime), then there exist polynomials $latex A_1(x), A_2(x), \dots, A_k(x)$ such that</p>
<p style="text-align: center;">$latex \displaystyle \frac{A(x)}{B(x)} = \frac{A_1(x)}{B_1(x)^{a_1}} + \frac{A_2(x)}{B_2(x)^{a_2}} + \cdots + \frac{A_k(x)}{B_k(x)^{a_k}}$.</p>
<p>In the context of a calculus course, we usually also want to know something about the degrees of the polynomials involved: If $latex \operatorname{deg} A &lt; \operatorname{deg} B$, then we can choose the $latex A_i$ such that $latex \operatorname{deg} A_i &lt; a_i \operatorname{deg} B_i$ for each $latex i$.

<p>How would we go about proving such a result? As is often the case, the general result presented above can be proven using the principle of mathematical induction once we have established the $latex k = 2$ case. The $latex k = 2$ case allows us to split off the irreducible factors of $latex B$ one at a time. The key to the proof is thus establishing the following result:</p>
<blockquote>
  <h4>Partial Fractions</h4>
  <p>Suppose that $latex A(x)$, $latex B(x)$, and $latex C(x)$ are polynomials such that $latex B(x)$ and $latex C(x)$ have no common factors of positive degree. Then there are polynomials $latex P(x)$ and $latex Q(x)$ such that</p>
  <p style="text-align: center;">$latex \displaystyle \frac{A(x)}{B(x) C(x)} = \frac{P(x)}{B(x)} + \frac{Q(x)}{C(x)}$.</p>
</blockquote>
<p>This result should be true even in the case where $latex A(x)$ is the constant polynomial $latex A(x) = 1$, and if fact it is sufficient to deal with this case, since if</p>
<p style="text-align: center;">$latex \displaystyle \frac{1}{B(x) C(x)} = \frac{P(x)}{B(x)} + \frac{Q(x)}{C(x)}$</p>
<p>then</p>
<p style="text-align: center;">$latex \displaystyle \frac{A(x)}{B(x) C(x)} = \frac{A(x)P(x)}{B(x)} + \frac{A(x)Q(x)}{C(x)}$.</p>
<p>We thus want to show that if we have polynomials $latex B(x)$ and $latex C(x)$ such that $latex \gcd(B(x), C(x)) = 1$, then there are polynomils $latex P(x)$ and $latex Q(x)$ such that</p>
<p style="text-align: center;">$latex \displaystyle P(x) C(x) + Q(x) B(x) = 1$.</p>
<p>Perhaps this section wasn't about something completely different after all: this is nothing other than a polynomial version of Bézout's Lemma!</p>

<h3>A word about the degrees of the polynomials</h3>

<p>We have thus far ignored the degrees of the polynomials involved. Our claim that it is sufficient to consider the case when $latex A(x) = 1$ does not take into account that when $latex A(x) \neq 1$, it is possible, and in fact not unlikely, that the degree of $latex A(x) P(x)$ is larger than the degree of $latex B(x)$. Let us address this now.</p>
<p>Suppose that $latex \operatorname{deg} A &lt; \operatorname{deg} B + \operatorname{deg} C$, and we have found polynomials $latex P$ and $latex Q$ such that</p>
<p style="text-align: center;">$latex \displaystyle A(x) = P(x) C(x) + Q(x) B(x)$.</p>
<p>We will show that we can replace $latex P$ with a polynomial of smaller degree than $latex B$, and $latex Q$ with a polynomial of smaller degree than $latex B$. Using the <em>division algorithm</em>, we know that $latex P(x) = S(x) B(x) + P^\prime (x)$ for some polynomial $latex S(x)$, and some polynomial $latex P^\prime (x)$ with the property that either $latex P^\prime (x) = 0$, or $latex \operatorname{deg} P^\prime &lt; \operatorname{deg} B$.</p>
<p>Let $latex Q^\prime = Q + SC$. Then we have that</p>
<p style="text-align: center;">$latex \displaystyle P^\prime C + Q^\prime B = (P - SB) C + (Q + SC) B = PC + QB - SBC + SCB = PC + QB = A$.</p>
<p>It is thus sufficient to show that $latex \operatorname{deg} Q^\prime &lt; \operatorname{deg} C$. But we know that</p>
<p style="text-align: center;">$latex \displaystyle \operatorname{deg} P^\prime C = \operatorname{deg} P^\prime + \operatorname{deg} C &lt; \operatorname{deg} B + \operatorname{deg} C$,</p>
<p>and by assumption we have that $latex \operatorname{deg} A &lt; \operatorname{deg} B + \operatorname{deg} C$, from which it follows that</p>
<p style="text-align: center;">$latex \displaystyle \operatorname{deg} Q^\prime + \operatorname{deg} B = \operatorname{deg} Q^\prime B = \operatorname{deg}(A - P^\prime C) \leq \max\{\operatorname{deg} A, \operatorname{deg} P^\prime C\} &lt; \operatorname{deg} B + \operatorname{deg} C$,</p>
<p>and so $latex \operatorname{deg} Q^\prime &lt; \operatorname{deg} C$.</p>

<h3>Proving the Polynomial Bézout's Lemma</h3>

<p>We can prove Bézout's Lemma for polynomials in essentially the same way as we did for integers: by exploiting the Euclidean Algorithm to calculate the greatest common divisor of two polynomials. Here we must be careful, however. In the polynomial version of the algorithm, if we replace two polynomials with the difference between these polynomials, then it is possible that the algorithm will never terminate. If we are dealing with polynomials with integer coefficients, then by carefully choosing which polynomial to replace, we can get away with always taking the difference between the two polynomials, but there is a better modification of the algorithm that works regardless of which field the coefficients of the polynomials belong to.</p>
<p>In the polynomial version of the algorithm, we should replace two polynomials $latex A$ and $latex B$ with the remainder when $latex A$ is divided by $latex B$. We always replace the polynomial with the larger degree, and in doing so we ensure that the larger of the two degrees never increases. We once again have that the sequence formed of the larger of the two degrees on each step is a non-increasing sequence of non-negative integers, and so must eventually be constant. At this point, the polynomial of smaller degree will be the constant polynomial $latex 0$, and the polynomial of larger degree will be the greatest common divisor of the two original polynomials.</p>
<p>Suppose that our two polynomials in question are $latex A$ and $latex B$. The other method that we can use to prove the lemma is instead to consider all polynomials of the form $latex SA + TB$ where $latex S$ and $latex T$ are polynomials. Let $latex D$ be the polynomial of this form that has the smallest degree. The polynomial $latex D$ is not unique, since if $latex D$ is of the appropriate form, then so is $latex cD$ where $latex c$ is some non-zero constant. If we are content with calling any such polynomial a greatest common divisor of $latex A$ and $latex B$, then we need not worry. Otherwise we further stipulate that $latex D$ is monic; i.e. that the leading coefficient of $latex D$ is $latex 1$.</p>
<p>We will show that $latex D$ divides both $latex A$ and $latex B$. As a consequence, we would have that $latex D$ is a divisor of $latex \gcd(A, B)$. On the other hand, we also know that $latex \gcd(A, B)$ divides every polynomial of the form $latex SA + TB$, and so $latex \gcd(A, B)$ is a divisor of $latex D$. These facts together imply that $latex D$ is a constant multiple of $latex \gcd(A, B)$. If we adopt the convention that both $latex \gcd(A, B)$ and $latex D$ are monic, then $latex D = \gcd(A, B)$.</p>
<p>Using the division algorithm, we can write $latex A = DQ + R$ where $latex Q$ is some polynomial, and either $latex R = 0$ or $latex \operatorname{deg} R &lt; \operatorname{deg} D$. We know that $latex D = SA + TB$ for some polynomials $latex S$ and $latex T$, and so we have that $latex A = Q(SA + TB) + R$, and so $latex $latex R = (1 - QS)A + (-QT)B$, which is also a linear combination of $latex A$ and $latex B$. If $latex R \neq 0$, then we know that $latex \operatorname{deg} R &lt; \operatorname{deg} D$, which contradicts the minimality of the degree of $latex D$. Thus we have that $latex R = 0$, and so $latex D$ divides $latex A$. A similar argument shows that $latex D$ divides $latex B$, as we claimed earlier.</p>

<!-- Delete from here onwards when copying to mathemafrica -->
</article>

<footer>
<nav>
  Return to <a href="../index.html">list of blog posts</a>
</nav>
</footer>

</body>
</html>
